<h3><%= t("views.index.title") %></h3>
<!--ここでは、form_withの引数にある「model: Task.new」で空の引き出しを作り、その中に検索したいタイトル名や
ステータス名を収納しコントローラに渡すことをしている。コントローラでは渡された情報を元にDBからwhere文などで
一致したデータを引っ張り出してindex.html.erb内で表示する流れになっている。-->
<%= form_with(model: Task.new, url: search_tasks_path, method: :get, local: true) do |f| %>
  <%= f.label :title_search, t("views.index.title_search") %>
  <%= f.text_field :title %>
  <%= f.label :status_search, t("views.index.status_search") %>
  <%= f.select :status, Task.statuses_i18n.invert, include_blank: true, selected: "" %>
  <!-- f.select :status, Task.statuses.map{ |k, v|[t("enums.task.status.#{k}"), v] }だと「'0' is not valid status」のerrorが起こる。
  これは、taskインスタンスのstatusフィールドに整数の0ではなく、文字列の”0”を渡そうとしているからである。formはデフォルトで ""がついてしまっている。-->
  <%#= f.hidden_field :search, value: "true" %>
  <!-- controllerのindexアクション内で送られてきたparametersをif params[:task][:search]で拾おうとすると
  「NoMethodError: undefined method `[]' for nil:NilClass」エラーが起こる。params[:search]とすると
  エラーは起こらないが今度は検索ができなくなる。-->
  <%= f.submit t("views.index.search") %>
<% end %>
<%= link_to t("views.index.end_time_limit_sort"), tasks_path(etl_sort: "true") %> |
<%= link_to t("views.index.priority_sort"), tasks_path(pri_sort: "true") %>
<div class="index-box">
  <% @tasks.each do |task| %>
    <div class="task_box">
      <p><%= task.status_i18n %></p>
      <p><%= Task.human_attribute_name :title %> : <%= task.title %></p>
      <p><%= Task.human_attribute_name :content %> : <%= task.content %></p>
      <p><%= Task.human_attribute_name :end_time_limit %> : <%= l(task.end_time_limit, format: :long) %></p>
      <p><%= Task.human_attribute_name :priority %> : <%= task.priority_i18n %></p>
      <%= link_to t("views.index.show"), task_path(task.id) %> |
      <%= link_to t("views.index.edit"), edit_task_path(task.id) %> |
      <%= link_to t("views.index.destroy"), task_path(task.id), method: :delete %>
    </div>
  <% end %>
</div>
